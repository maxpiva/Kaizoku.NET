# API Changes During Mihon Migration

This document tracks every controller endpoint and model change introduced while replacing Suwayomi with Mihon.ExtensionsBridge.

| Date | Area | Endpoint/Model | Change | Notes |
| --- | --- | --- | --- | --- |
| 2026-02-05 | Data Migration | Runtime bootstrap | Added `Migration` orchestrator that detects `kaizoku.db`, spins up the Mihon bridge, and begins copying settings into the new schema (remaining entity steps pending). | No controller schema affected yet. |
| 2026-02-06 | Data Migration | Provider sync | Migration now installs Mihon extensions for each enabled legacy provider, reapplies source preferences, and persists `ProviderStorage` rows for later entity migration. | Preps future controller updates; no API schema changes yet. |
| 2026-02-07 | Data Migration | Series provider sync | Migration resolves each legacy series provider to Mihon sources, enriches metadata via bridge lookups, links to the installed provider/source identifiers, and records thumbnail remaps for downstream series migration. | Still internal-only; controller surface unchanged. |
| 2026-02-08 | Data Migration | Series metadata | Migration now copies legacy series records, applies thumbnail remaps from enriched providers, and repopulates the new `Series` table ahead of future API enablement. | Controller/model contracts unchanged for now. |
| 2026-02-10 | API Models | Linked/Small/Full series DTOs | Introduced `SeriesSummaryBase` shared type for Mihon-linked series payloads; no JSON schema changes because properties remain identical. | Refactor only; controller responses unaffected. |
| 2026-02-10 | API Models | Provider DTOs | Added `ProviderSummaryBase` and updated `ProviderInfo`, `SmallProviderDto`, and `ProviderExtendedDto` to derive from it (extended DTO still emits `lang`). | Refactor only; responses stay compatible. |
| 2026-02-10 | API Models | Download DTOs | Added `DownloadSummaryBase` shared across `ChapterDownload`, `DownloadInfoDto`, and `DownloadCardInfoDto`; field names remain the same on the wire. | Refactor only; API unchanged. |
| 2026-02-10 | API Models | Import metadata | Added `ImportSummaryBase` so `ImportInfo`, `AugmentedResponseDto`, and `KaizokuInfo` share normalized path handling (no JSON contract changes). | Refactor only; internal logic simplified. |
| 2026-02-10 | API Models | Provider DTOs | Expanded `ProviderSummaryBase` to include title/thumbnail/status/url so ProviderInfo/SmallProviderDto/ProviderExtendedDto share metadata (overrides preserve existing JSON output). | Contract unchanged; reduces duplication. |
| 2026-02-10 | API Models | Series DTOs | Added `SeriesProviderDetailsBase` so `FullSeries` and `SmallSeries` share provider-level metadata (scanlator/url/chapter counts) without affecting linked-series payloads. | Structural refactor only; JSON contract preserved. |
| 2026-02-11 | Domain Models | Chapter projections | Introduced `ChapterDescriptorBase` for `Chapter`/`ArchiveInfo` so chapter number/index logic lives in one place (no schema change). | Internal refactor only. |
| 2026-02-11 | Domain Models | Series metadata | Added `SeriesMetadata` helper and wired `SeriesEntity`/`BaseSeriesDto`/`SeriesProviderDetailsBase` to reuse storage-path/chapter normalization. | Internal refactor only. |
| 2026-02-11 | API Models | Download DTOs | Added `DownloadSummary` + projection helpers for `DownloadInfoDto`/`DownloadCardInfoDto`, paving way for unified queue mappings. | Controller contracts unchanged. |
| 2026-02-11 | Domain Models | Provider storage | `SeriesProviderEntity` now derives from `ProviderSummaryBase`, keeping provider metadata aligned with API DTOs. | Structural refactor only. |
| 2026-02-12 | Migration Models | Chapter payloads | `Migration.Models.Chapter` now derives from `ChapterDescriptorBase`, sharing chapter number/index semantics with runtime models. | Internal refactor ensures migration/export parity. |
| 2026-02-12 | API Models | Series metadata | `SeriesSummaryBase`/`SeriesProviderDetailsBase` now share a `SeriesMetadata` provider segment, centralizing chapter counts, chapter lists, and use-title flags. | Structural refactor; JSON unchanged. |
| 2026-02-12 | API Models | Download queue endpoints | `DownloadCommandService` and query endpoints now build `DownloadSummary` objects once before projecting to DTOs, preventing drift between queue and UI payloads. | Contract unchanged; reduces duplication. |
| 2026-02-12 | API Models | Provider preferences | `ProviderStorageEntity` and `ProviderPreferencesDto` now inherit `ProviderSummaryBase`, so preference responses include the same provider metadata as other DTOs. | Structural refactor only. |
| 2026-02-12 | API Models | Series normalization | Removed the `SeriesMetadata`/`SeriesProviderMetadata` classes; `BaseSeriesDto`, `SeriesEntity`, and the series provider DTO bases now manage storage-path and chapter data directly (shared helper methods only). | JSON contracts unchanged; reduces indirection. |
| 2026-02-12 | Import Models | Import metadata | Added `ImportSeriesResult` + helper extensions so `KaizokuInfo`/`ImportInfo` reuse the same provider/chapter projections (ImportCommandService + SeriesComparer now consume the shared metadata). | Shared DTO only; JSON field names unchanged. |
| 2026-02-12 | API Models | Provider cache | Introduced `ProviderSummaryExtensions.ToSmallProviderDto` + `ProviderCacheService.GetCachedProviderSummariesAsync` so cache consumers no longer hand-build provider snippets. | Structural improvement; payloads stay the same. |
| 2026-02-12 | Job Hub | Progress payloads | `ProgressState` now carries a typed download payload derived from `DownloadSummary`, and download jobs pass summaries instead of bespoke DTOs. | SignalR message schema adds optional `download` node mirroring REST DTOs. |
| 2026-02-12 | Import Models | Chapter metrics | Added `ImportChapterMetrics` + `ImportMetricsExtensions` so `ImportQueryService`, `SeriesScanner`, and other import flows share total-chapter/provider counting logic. | Structural refactor; API totals stay identical. |
| 2026-02-12 | Provider Metadata | Search/match DTOs | `MatchInfoDto` and `SearchSourceDto` now inherit `ProviderSummaryBase`, keeping provider/lang/scanlator details consistent with other DTOs. | JSON output unchanged; reduces drift. |
| 2026-02-12 | Provider Cache | Search sources endpoint | Added `ProviderCacheService.GetProviderSummariesForLanguagesAsync` and switched `SearchQueryService.GetAvailableSearchSourcesAsync` to consume the summaries, avoiding repeated entity → DTO projections. | No schema change; improves cache hit path. |
| 2026-02-12 | Job Hub | Progress payloads | Removed the legacy `ProgressState.parameter` field; hub clients must consume the typed `download` node (jobs now pass `DownloadSummary` directly). | SignalR schema simpler; `parameter` always null going forward. |
| 2026-02-12 | Import Models | Terminology | Renamed `KaizokuInfo` → `ImportSeriesSnapshot`, `FullSeries` → `ProviderSeriesDetails`, and `SmallSeries` → `ProviderSeriesOption` to better reflect their roles while keeping JSON contracts identical. | Rename only; controller payloads unaffected. |
| 2026-02-12 | Import Models | Terminology | Renamed `ArchiveInfo` → `ProviderArchiveSnapshot`, `ProviderInfo` → `ImportProviderSnapshot`, and `ImportInfo` → `ImportSeriesEntry` to align naming across import snapshots without changing JSON contracts. | Rename only; controller payloads unaffected. |
| 2026-02-12 | Setup Wizard | `POST /api/setup/import` | Endpoint now only accepts the `disableDownloads` query parameter and no longer consumes a request body; clients should call `/api/setup/import?disableDownloads={bool}` to enqueue the job. | Response remains `{ success, message }`. |
| 2026-02-12 | API Models | Search sources | `SearchSourceDto` now uses Mihon identifiers (`mihonProviderId`) and provider metadata fields (provider/scanlator/language/title/thumbnail/status/url) instead of legacy `sourceId`/`sourceName` payloads. | Client filters should use Mihon provider IDs. |
| 2026-02-15 | API Models | Settings DTO | Confirmed SOCKS proxy fields (`socksProxyEnabled`, `socksProxyVersion`, `socksProxyHost`, `socksProxyPort`, `socksProxyUsername`, `socksProxyPassword`) are part of `EditableSettingsDto`/`SettingsDto` and now exposed in the settings UI. | No controller route changes; UI now surfaces existing model fields. |
